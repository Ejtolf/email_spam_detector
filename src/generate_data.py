import pandas as pd
import random
from faker import Faker
from datetime import datetime, timedelta

fake = Faker('ru_RU')

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è "—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö" –ø–æ–ª–µ–π
def generate_email(is_spam):
    services = ['Yandex Mail', 'Gmail', 'Mail.ru', 'Outlook']
    domains = ['.ru', '.com', '.net', '.cc', '.click', '.info']
    spam_titles = [
        "üî• –í—ã–≥–æ–¥–∞ –¥–æ 90%!", "–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ iPhone", "–û—Å—Ç–∞–ª—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥",
        "–í—ã –ø–æ–ª—É—á–∏–ª–∏ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é!", "üö® –ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –≤–∑–ª–æ–º", "–í–∞–º –¥–æ—Å—Ç—É–ø–µ–Ω –±–æ–Ω—É—Å",
        "–£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ!", "–ü—Ä–æ–π–¥–∏—Ç–µ –æ–ø—Ä–æ—Å –∏ –ø–æ–ª—É—á–∏—Ç–µ –ø–æ–¥–∞—Ä–æ–∫", "–î–µ–Ω—å–≥–∏ –∂–¥—É—Ç –≤–∞—Å!",
        "–í–∞—à–∞ –∫–∞—Ä—Ç–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞"
    ]
    ham_titles = [
        "–æ—Ç–≤–µ—Ç –∑–∞ –æ—Ñ—Ñ–µ—Ä", "–†–µ–∑—é–º–µ –ø—Ä–∏–Ω—è—Ç–æ", "–ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—Å—Ç—Ä–µ—á—É", "–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –≤–µ–±–∏–Ω–∞—Ä–µ",
        "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏–π –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è", "–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏", "–ü–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é",
        "–í–∞—à –∑–∞–∫–∞–∑ –≥–æ—Ç–æ–≤", "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è", "–ü–∏—Å—å–º–æ –æ—Ç —Ä–µ–∫—Ä—É—Ç–µ—Ä–∞"
    ]
    
    spam_bodies = [
        "–°–µ–∫—Ä–µ—Ç–Ω—ã–µ —Å–∫–∏–¥–∫–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∞—Å! –ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –∏ –ø–æ–ª—É—á–∏—Ç–µ 90% –Ω–∞ Rolex, Nike, Apple.",
        "–í—ã –±—ã–ª–∏ –≤—ã–±—Ä–∞–Ω—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ iPhone 15! –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∞–Ω–∫–µ—Ç—É —Å–µ–π—á–∞—Å!",
        "–í–∞—à –∫–æ—à–µ–ª—ë–∫ –≤—ã–±—Ä–∞–Ω –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å—Ä–µ–¥—Å—Ç–≤ –æ—Ç –¶–µ–Ω—Ç—Ä–æ–±–∞–Ω–∫–∞. –ü–æ–ª—É—á–∏—Ç–µ 183 000‚ÇΩ!",
        "–ü—Ä–æ–π–¥–∏—Ç–µ –∫–æ—Ä–æ—Ç–∫–∏–π –æ–ø—Ä–æ—Å –∏ –ø–æ–ª—É—á–∏—Ç–µ 5 000 —Ä—É–±–ª–µ–π –Ω–∞ –∫–∞—Ä—Ç—É.",
        "–°—Ä–æ—á–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ, –∏–Ω–∞—á–µ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç –±—É–¥–µ—Ç –∑–∞–º–æ—Ä–æ–∂–µ–Ω.",
        "–ê–∫—Ü–∏—è! –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∫–∏–Ω–æ. –£—Å–ø–µ–π –¥–æ –ø–æ–ª—É–Ω–æ—á–∏.",
        "–ù–∞–∂–º–∏ –∑–¥–µ—Å—å –∏ –ø–æ–ª—É—á–∏ –ø–æ–¥–∞—Ä–æ–∫!",
        "–í–∞—à–∞ –∫–∞—Ä—Ç–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ª–∏—á–Ω–æ—Å—Ç—å, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ.",
        "–ü–æ–ª—É—á–∏—Ç–µ –±–æ–Ω—É—Å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å! –¢–æ–ª—å–∫–æ —Å–µ–≥–æ–¥–Ω—è.",
        "–ú—ã –Ω–µ –º–æ–∂–µ–º –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Å–µ–π—á–∞—Å."
    ]
    
    ham_bodies = [
        "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ú—ã –æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å —Å –≤–∞—à–∏–º —Ä–µ–∑—é–º–µ –∏ –≥–æ—Ç–æ–≤—ã –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é.",
        "–°–ø–∞—Å–∏–±–æ –∑–∞ —É—á–∞—Å—Ç–∏–µ –≤ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏. –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –ø–æ–∑–∂–µ.",
        "–í–∞—à –∑–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω. –î–æ—Å—Ç–∞–≤–∫–∞ –æ–∂–∏–¥–∞–µ—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 3 –¥–Ω–µ–π.",
        "–î–æ–±—Ä—ã–π –¥–µ–Ω—å! –ù–∞–ø–æ–º–∏–Ω–∞–µ–º –æ –≤–µ–±–∏–Ω–∞—Ä–µ –ø–æ —Ü–∏—Ñ—Ä–æ–≤—ã–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º –∑–∞–≤—Ç—Ä–∞ –≤ 11:00.",
        "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã, —á—Ç–æ–±—ã –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é.",
        "–î–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ–ª—É—á–µ–Ω—ã. –û–∂–∏–¥–∞–π—Ç–µ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –æ—Ç –Ω–∞—à–µ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞.",
        "–û—Ç—á—ë—Ç –ø–æ –ø—Ä–æ–µ–∫—Ç—É –≤–æ –≤–ª–æ–∂–µ–Ω–∏–∏. –ü—Ä–æ—Å–∏–º –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è –¥–æ –∫–æ–Ω—Ü–∞ –Ω–µ–¥–µ–ª–∏.",
        "–°–æ–∑–≤–æ–Ω –ø–æ –ø—Ä–æ–µ–∫—Ç—É –Ω–∞–∑–Ω–∞—á–µ–Ω –Ω–∞ –∑–∞–≤—Ç—Ä–∞ –≤ 14:00.",
        "–°–ø–∞—Å–∏–±–æ –∑–∞ –±—ã—Å—Ç—Ä—É—é —Ä–µ–∞–∫—Ü–∏—é. –í–æ–ø—Ä–æ—Å —Ä–µ—à—ë–Ω.",
        "–ü—Ä–∏–ª–æ–∂–µ–Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å–µ—Ä–≤–∏—Å–∞."
    ]
    
    title = random.choice(spam_titles if is_spam else ham_titles)
    text = random.choice(spam_bodies if is_spam else ham_bodies)
    date = fake.date_between(start_date='-60d', end_date='today')
    address = fake.user_name() + '@' + fake.domain_name()
    service = random.choice(services)
    
    return {
        "title": title,
        "text": text,
        "date": date.strftime('%Y-%m-%d'),
        "adress": address,
        "service": service,
        "is_spam": int(is_spam)
    }

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞
n_samples = 5000
data = [generate_email(is_spam=(i < n_samples // 2)) for i in range(n_samples)]

df = pd.DataFrame(data)
df.to_csv('../data/raw/spam_dataset.csv', index=False)
df.head()

print('Dataset has been saved to data/raw/spam_dataset.csv')
